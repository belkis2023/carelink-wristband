# CareLink Wristband Architecture

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Flutter Mobile App                       â”‚
â”‚                  (Android / iOS / Web)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ HTTP/HTTPS
                              â”‚ (JSON)
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Flask REST API                          â”‚
â”‚                   (Python 3.8+)                              â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Auth      â”‚  â”‚  Dashboard  â”‚  â”‚   Profile   â”‚        â”‚
â”‚  â”‚  Routes     â”‚  â”‚   Routes    â”‚  â”‚   Routes    â”‚        â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚        â”‚
â”‚  â”‚ â€¢ Signup    â”‚  â”‚ â€¢ Metrics   â”‚  â”‚ â€¢ Get       â”‚        â”‚
â”‚  â”‚ â€¢ Login     â”‚  â”‚ â€¢ Readings  â”‚  â”‚ â€¢ Update    â”‚        â”‚
â”‚  â”‚ â€¢ Logout    â”‚  â”‚             â”‚  â”‚             â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Alerts    â”‚  â”‚   JWT Authentication         â”‚         â”‚
â”‚  â”‚   Routes    â”‚  â”‚   (7-day token expiration)   â”‚         â”‚
â”‚  â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”‚ â€¢ List      â”‚                                            â”‚
â”‚  â”‚ â€¢ Create    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ â€¢ Mark Read â”‚  â”‚   CORS Middleware            â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   (Flutter connectivity)     â”‚         â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ SQL
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SQLite Database                           â”‚
â”‚                   (carelink.db)                              â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  users   â”‚  â”‚ profiles â”‚  â”‚ readings â”‚  â”‚  alerts  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Application Flow

### User Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     signup/login      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flutter  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Flask API  â”‚
â”‚    App    â”‚                       â”‚   /auth     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                    â”‚
      â”‚                                    â”‚ Validate
      â”‚                                    â–¼
      â”‚                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                             â”‚  Database   â”‚
      â”‚                             â”‚   (users)   â”‚
      â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                    â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€JWT Tokenâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ (Save to SharedPreferences)
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Connection â”‚
â”‚   Test    â”‚
â”‚  Screen   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ (Skip for Now)
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dashboard â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Retrieval Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    GET /dashboard/metrics    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dashboard â”‚â”€â”€â”€â”€â”€â”€(with JWT token)â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Flask API  â”‚
â”‚  Screen   â”‚                               â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                            â”‚
      â”‚                                            â”‚ Query
      â”‚                                            â–¼
      â”‚                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                     â”‚  Database   â”‚
      â”‚                                     â”‚  (readings) â”‚
      â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                            â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€JSON Responseâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ (Display data)
      â–¼
```

---

## Flutter App Structure

```
lib/
â”œâ”€â”€ main.dart                              [Entry point, auth check]
â”‚
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ constants/                         [App-wide constants]
â”‚   â”‚   â”œâ”€â”€ app_colors.dart
â”‚   â”‚   â”œâ”€â”€ app_text_styles.dart
â”‚   â”‚   â””â”€â”€ app_constants.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ theme/                             [App theming]
â”‚   â”‚   â””â”€â”€ app_theme.dart
â”‚   â”‚
â”‚   â””â”€â”€ services/                          [Backend communication]
â”‚       â””â”€â”€ api_service.dart               [â˜… API Client with JWT]
â”‚
â”œâ”€â”€ features/                              [Feature modules]
â”‚   â”œâ”€â”€ auth/                              [Authentication]
â”‚   â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”‚   â”œâ”€â”€ login_screen.dart          [â˜… Updated]
â”‚   â”‚   â”‚   â”œâ”€â”€ signup_screen.dart         [â˜… Updated]
â”‚   â”‚   â”‚   â””â”€â”€ forgot_password_screen.dart
â”‚   â”‚   â””â”€â”€ widgets/
â”‚   â”‚       â””â”€â”€ auth_text_field.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ connection/                        [â˜… NEW]
â”‚   â”‚   â””â”€â”€ screens/
â”‚   â”‚       â””â”€â”€ connection_test_screen.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ dashboard/                         [Main dashboard]
â”‚   â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”‚   â””â”€â”€ dashboard_screen.dart
â”‚   â”‚   â””â”€â”€ widgets/
â”‚   â”‚       â”œâ”€â”€ stress_level_card.dart
â”‚   â”‚       â”œâ”€â”€ metric_card.dart
â”‚   â”‚       â””â”€â”€ haptic_toggle_card.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ settings/                          [Settings & profile]
â”‚   â”‚   â”œâ”€â”€ screens/
â”‚   â”‚   â”‚   â”œâ”€â”€ settings_screen.dart       [â˜… Updated]
â”‚   â”‚   â”‚   â””â”€â”€ edit_profile_screen.dart
â”‚   â”‚   â””â”€â”€ widgets/
â”‚   â”‚       â”œâ”€â”€ profile_card.dart
â”‚   â”‚       â””â”€â”€ settings_menu_item.dart
â”‚   â”‚
â”‚   â”œâ”€â”€ history/                           [Historical data]
â”‚   â”‚   â””â”€â”€ screens/
â”‚   â”‚       â””â”€â”€ history_screen.dart
â”‚   â”‚
â”‚   â””â”€â”€ alerts/                            [Notifications]
â”‚       â”œâ”€â”€ screens/
â”‚       â”‚   â””â”€â”€ alerts_screen.dart
â”‚       â””â”€â”€ widgets/
â”‚           â”œâ”€â”€ alert_item_card.dart
â”‚           â””â”€â”€ alert_threshold_card.dart
â”‚
â”œâ”€â”€ navigation/                            [Routing]
â”‚   â””â”€â”€ app_router.dart                    [â˜… Updated]
â”‚
â””â”€â”€ shared/                                [Shared widgets]
    â””â”€â”€ widgets/
        â”œâ”€â”€ custom_app_bar.dart
        â”œâ”€â”€ custom_button.dart
        â”œâ”€â”€ custom_card.dart
        â””â”€â”€ bottom_nav_bar.dart

â˜… = Modified or new files
```

---

## Backend Structure

```
backend/
â”œâ”€â”€ app.py                    [Main Flask application]
â”‚   â”œâ”€â”€ Initializes Flask
â”‚   â”œâ”€â”€ Configures CORS
â”‚   â”œâ”€â”€ Initializes JWT
â”‚   â”œâ”€â”€ Registers blueprints
â”‚   â””â”€â”€ Runs dev server
â”‚
â”œâ”€â”€ config.py                 [Configuration]
â”‚   â”œâ”€â”€ JWT secret keys
â”‚   â”œâ”€â”€ Token expiration
â”‚   â””â”€â”€ Database path
â”‚
â”œâ”€â”€ database.py               [Database utilities]
â”‚   â”œâ”€â”€ get_db()             [Connection management]
â”‚   â”œâ”€â”€ close_db()           [Cleanup]
â”‚   â””â”€â”€ init_db()            [Table creation]
â”‚
â”œâ”€â”€ routes/                   [API endpoints]
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ auth.py              [Authentication]
â”‚   â”‚   â”œâ”€â”€ POST /api/auth/signup
â”‚   â”‚   â”œâ”€â”€ POST /api/auth/login
â”‚   â”‚   â”œâ”€â”€ POST /api/auth/logout
â”‚   â”‚   â””â”€â”€ GET  /api/auth/me
â”‚   â”‚
â”‚   â”œâ”€â”€ dashboard.py         [Dashboard data]
â”‚   â”‚   â”œâ”€â”€ GET  /api/dashboard/metrics
â”‚   â”‚   â””â”€â”€ POST /api/dashboard/readings
â”‚   â”‚
â”‚   â”œâ”€â”€ profile.py           [Profile management]
â”‚   â”‚   â”œâ”€â”€ GET  /api/profile
â”‚   â”‚   â””â”€â”€ PUT  /api/profile
â”‚   â”‚
â”‚   â””â”€â”€ alerts.py            [Alert management]
â”‚       â”œâ”€â”€ GET  /api/alerts
â”‚       â”œâ”€â”€ POST /api/alerts
â”‚       â””â”€â”€ PUT  /api/alerts/<id>/read
â”‚
â”œâ”€â”€ requirements.txt          [Python dependencies]
â”œâ”€â”€ README.md                [Documentation]
â””â”€â”€ carelink.db              [SQLite database (auto-created)]
```

---

## Database Schema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         users                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                                                  â”‚
â”‚ email (UNIQUE)                                          â”‚
â”‚ password_hash                                           â”‚
â”‚ full_name                                               â”‚
â”‚ created_at                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ 1:1
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       profiles                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                                                  â”‚
â”‚ user_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚ name                                    â”‚               â”‚
â”‚ age                                     â”‚               â”‚
â”‚ date_of_birth                           â”‚               â”‚
â”‚ relationship                            â”‚               â”‚
â”‚ emergency_contact_name                  â”‚               â”‚
â”‚ emergency_contact_phone                 â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚ 1:N
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   wristband_readings                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                                                  â”‚
â”‚ user_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚ heart_rate                              â”‚               â”‚
â”‚ motion                                  â”‚               â”‚
â”‚ noise_level                             â”‚               â”‚
â”‚ stress_level                            â”‚               â”‚
â”‚ battery                                 â”‚               â”‚
â”‚ timestamp                               â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â”‚ 1:N
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        alerts                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                                                  â”‚
â”‚ user_id (FK)                                            â”‚
â”‚ type                                                    â”‚
â”‚ title                                                   â”‚
â”‚ message                                                 â”‚
â”‚ is_read                                                 â”‚
â”‚ created_at                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Request Flow

### Protected Endpoint Example

```
1. Flutter App
   â”‚
   â”œâ”€> Check SharedPreferences for JWT token
   â”‚   â””â”€> Token found: "eyJhbGci..."
   â”‚
   â””â”€> Make HTTP GET request
       â”‚
       â”œâ”€> URL: http://10.0.2.2:5000/api/dashboard/metrics
       â”œâ”€> Headers: {
       â”‚     "Content-Type": "application/json",
       â”‚     "Authorization": "Bearer eyJhbGci..."
       â”‚   }
       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
                                                     â”‚
                                               2. Flask API
                                                     â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                    â”‚ JWT Middleware â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                                     â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                                    â”‚ Verify token signature â”‚
                                    â”‚ Check expiration       â”‚
                                    â”‚ Extract user_id        â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                              3. Route Handler
                                                     â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                                    â”‚ Query database         â”‚
                                    â”‚ Get readings for user  â”‚
                                    â”‚ Format response        â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€> Response: {
       â”‚     "stress_level": 6.2,
       â”‚     "heart_rate": 78,
       â”‚     ...
       â”‚   }
       â”‚
4. Flutter App
   â”‚
   â””â”€> Parse JSON
       â””â”€> Update UI
```

---

## JWT Token Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Signup  â”‚                              â”‚  Login   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                         â”‚
     â”‚ POST /auth/signup                      â”‚ POST /auth/login
     â”‚ { email, password, name }              â”‚ { email, password }
     â–¼                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Flask API                          â”‚
â”‚                                                       â”‚
â”‚  1. Validate input                                   â”‚
â”‚  2. Hash password (signup)                           â”‚
â”‚  3. Check password (login)                           â”‚
â”‚  4. Create JWT token:                                â”‚
â”‚     {                                                â”‚
â”‚       "sub": user_id,                                â”‚
â”‚       "iat": issued_at,                              â”‚
â”‚       "exp": expires_at (7 days)                     â”‚
â”‚     }                                                â”‚
â”‚  5. Sign with secret key                            â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Return: { access_token, user }
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Flutter App   â”‚
              â”‚                â”‚
              â”‚  Save token:   â”‚
              â”‚  - Memory      â”‚
              â”‚  - SharedPrefs â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ All subsequent requests
                       â–¼
              Authorization: Bearer <token>
```

---

## Connection Test Screen States

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         State 1: SEARCHING                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                            â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚         â”‚    âŒš     â”‚  (Blue)               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                            â”‚
â”‚   Searching for Wristband...               â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â—‹â•â•â•â•â•â•â•â•â•â•â•                â”‚
â”‚   (CircularProgressIndicator)             â”‚
â”‚                                            â”‚
â”‚   Make sure wristband is on...            â”‚
â”‚                                            â”‚
â”‚   [Skip for Now]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ After 2 seconds
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         State 2: NOT FOUND                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                            â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚         â”‚    âŒš     â”‚  (Orange)             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚              â•³                             â”‚
â”‚                                            â”‚
â”‚   Wristband Not Found                      â”‚
â”‚                                            â”‚
â”‚   Could not find wristband...              â”‚
â”‚                                            â”‚
â”‚   [ğŸ”„ Try Again]                           â”‚
â”‚   [Skip for Now]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ When BLE added
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         State 3: CONNECTED                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                            â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚         â”‚    âŒš     â”‚  (Green)              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚              âœ“                             â”‚
â”‚                                            â”‚
â”‚   Connected!                               â”‚
â”‚                                            â”‚
â”‚   Wristband is ready...                   â”‚
â”‚                                            â”‚
â”‚   [Continue to Dashboard â†’]                â”‚
â”‚   [Skip for Now]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Technology Stack

### Frontend (Flutter)
```
â”œâ”€ Framework: Flutter 3.10.1+
â”œâ”€ Language: Dart ^3.10.1
â”œâ”€ State: StatefulWidget
â””â”€ Dependencies:
   â”œâ”€ http ^1.1.0            (API calls)
   â”œâ”€ shared_preferences      (Token storage)
   â”œâ”€ fl_chart ^0.68.0        (Charts)
   â””â”€ cupertino_icons ^1.0.8  (Icons)
```

### Backend (Flask)
```
â”œâ”€ Framework: Flask 3.0.0
â”œâ”€ Language: Python 3.8+
â””â”€ Dependencies:
   â”œâ”€ Flask-CORS 4.0.0        (CORS)
   â”œâ”€ Flask-JWT-Extended 4.6.0 (Auth)
   â”œâ”€ bcrypt 4.1.2            (Password hashing)
   â””â”€ python-dotenv 1.0.0     (Config)
```

### Database
```
â””â”€ SQLite 3
   â”œâ”€ Lightweight
   â”œâ”€ Serverless
   â”œâ”€ File-based (carelink.db)
   â””â”€ Perfect for development
```

---

## Security Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Security Layers                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  1. Password Security                   â”‚
â”‚     â””â”€> bcrypt hashing                 â”‚
â”‚         â””â”€> Salt + hash                â”‚
â”‚                                         â”‚
â”‚  2. JWT Authentication                  â”‚
â”‚     â””â”€> Signed tokens                  â”‚
â”‚         â””â”€> 7-day expiration           â”‚
â”‚                                         â”‚
â”‚  3. Protected Routes                    â”‚
â”‚     â””â”€> @jwt_required decorator        â”‚
â”‚         â””â”€> Verify token on request    â”‚
â”‚                                         â”‚
â”‚  4. Email Validation                    â”‚
â”‚     â””â”€> Regex pattern                  â”‚
â”‚         â””â”€> Prevent invalid emails     â”‚
â”‚                                         â”‚
â”‚  5. HTTPS Ready                         â”‚
â”‚     â””â”€> Production: use HTTPS          â”‚
â”‚         â””â”€> Encrypt all traffic        â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Future Enhancements

### Phase 1: BLE Integration (Next)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Wristband   â”‚  BLE
â”‚    Device    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Flutter App    â”‚
                    â”‚  + BLE Plugin   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTP
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Flask API     â”‚
                    â”‚  /readings      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 2: Real-time Updates
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     WebSocket    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flutter App â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  Flask API  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                                  â”‚
      â”‚ Live metrics                     â”‚
      â”‚ Push notifications               â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Phase 3: Production Deployment
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTPS        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Mobile App  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  AWS/Heroku â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ PostgreSQL  â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary

This architecture provides:

âœ… **Scalability** - Modular design, easy to extend
âœ… **Security** - JWT auth, password hashing, protected routes
âœ… **Maintainability** - Clear separation of concerns
âœ… **Testability** - Independent components
âœ… **Flexibility** - Easy to swap database or add features
âœ… **Documentation** - Well-documented codebase

**Status:** Production-ready for testing and BLE integration!
